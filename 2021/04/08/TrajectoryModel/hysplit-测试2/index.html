<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jackzheng-lu.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="项目记录 创新点：  研究SPE的Be7运移  已经可以进行全球的模拟，但是得使用GRAD 1°的数据，NCEP数据有问题  如何实现全球范围的释放 含有Be10特性的模拟问题 实现1个月的模拟 解决NCEP的问题 Sulfate 模块运行问题（可能要看下源程序；进行修改添加）  发现问题，使用GADS的时候，并不能读取source文件，提示source point 不再gird上，无输出结果。">
<meta property="og:type" content="article">
<meta property="og:title" content="hysplit_conc测试">
<meta property="og:url" content="http://jackzheng-lu.github.io/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/index.html">
<meta property="og:site_name" content="JackZHENG_blog">
<meta property="og:description" content="项目记录 创新点：  研究SPE的Be7运移  已经可以进行全球的模拟，但是得使用GRAD 1°的数据，NCEP数据有问题  如何实现全球范围的释放 含有Be10特性的模拟问题 实现1个月的模拟 解决NCEP的问题 Sulfate 模块运行问题（可能要看下源程序；进行修改添加）  发现问题，使用GADS的时候，并不能读取source文件，提示source point 不再gird上，无输出结果。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://jackzheng-lu.github.io/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/image-20210409152543732.png">
<meta property="article:published_time" content="2021-04-08T02:48:09.000Z">
<meta property="article:modified_time" content="2021-04-29T05:01:50.429Z">
<meta property="article:author" content="JackZheng">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jackzheng-lu.github.io/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/image-20210409152543732.png">

<link rel="canonical" href="http://jackzheng-lu.github.io/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>hysplit_conc测试 | JackZHENG_blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">JackZHENG_blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://jackzheng-lu.github.io/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JackZheng">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JackZHENG_blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          hysplit_conc测试
        </h1>
    
        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
    
              <time title="Created: 2021-04-08 10:48:09" itemprop="dateCreated datePublished" datetime="2021-04-08T10:48:09+08:00">2021-04-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-29 13:01:50" itemprop="dateModified" datetime="2021-04-29T13:01:50+08:00">2021-04-29</time>
              </span>
    
          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数: </span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时间 &asymp;</span>
              <span>2 mins.</span>
            </span>
    
        </div>
      </header>
    
    
    
    
    <div class="post-body" itemprop="articleBody">
    
      
        <p>项目记录</p>
<p>创新点：</p>
<ul>
<li>研究SPE的Be7运移</li>
</ul>
<p>已经可以进行全球的模拟，但是得使用GRAD 1°的数据，NCEP数据有问题</p>
<ul>
<li>如何实现全球范围的释放</li>
<li>含有Be10特性的模拟问题</li>
<li>实现1个月的模拟</li>
<li>解决NCEP的问题</li>
<li>Sulfate 模块运行问题（可能要看下源程序；进行修改添加）</li>
</ul>
<p>发现问题，使用GADS的时候，并不能读取source文件，提示source point 不再gird上，无输出结果。</p>
<blockquote>
<p>发现如果不在control的文件里设置emission，就不会有值。这很奇怪，因为我用NCAR的数据还好好的</p>
<p>一种解决方法就是：在emission里面，把时间设置为数值，就能解决。（不过仍然不知道为啥有这问题）</p>
</blockquote>
<p>(Yaqiang Wang et al 2011 ER),设置为每6小时到GEM中去，一共1600,000个particles</p>
<p>面积</p>
<h1 id="经验"><a href="#经验" class="headerlink" title="经验"></a>经验</h1><p>以后control，setup等的内部选项只增不减，并添加上简要的解释。方便于我修改参数。</p>
<p>每6小时的trajectory，可以在setup.cfg中设定NSTR=6。也可以多条/多时间的变化（看user-guide）。</p>
<p>总是要记得备份，尤其是模拟不同时段的运移模型时候</p>
<p>注意在运行SPE事件的时候，采样浓度要多层次level，因为高浓度的Be10并不会降下来。计算的浓度时根据设定来的</p>
<blockquote>
<p>这也是为啥有时候会出现无浓度的情况，因为设置不对。</p>
<p>同时也要注意，GEM和Hysplit有各自浓度的设定。</p>
</blockquote>
<p>由于source点比较稀疏，可以设置release的面积</p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><h2 id="program-exception-access-violation的问题"><a href="#program-exception-access-violation的问题" class="headerlink" title="program exception-access violation的问题"></a>program exception-access violation的问题</h2><p>运行Hysplit出现的program exception-access violation的问题。我在运行30天的back-trajectory或者大面积的forward的时候，都出现了这个<code>program exception-access violation</code>的问题。Google之后发现Fortran出现这个一般都是数组越界。因为hysplit为了增加计算时间默认了mgmin为10°，我猜测这个容易造成越界问题。</p>
<p>解决方法是</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MGMIN=40</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果想要全球尺度的，可以改为999。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 但是如果多点的话，不推荐这样做，因为极大增加了运算时间。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>详细的可以看看user-guide里面介绍的sub-grid size。对于长时间尺度的运移，MGMIN太小的话，有可能造成不同时间的sub-gird在空间上没有重叠。</p>
</blockquote>
<h2 id="NCEP-terrain-height的问题"><a href="#NCEP-terrain-height的问题" class="headerlink" title="NCEP terrain height的问题"></a>NCEP terrain height的问题</h2><p>我跑了NCEP的30天的back-trajectory，发现里面的地形出现了负数（一般在海洋地区）。查资料发现，原来NCEP本身是不提供地形资料的。地形资料是通过如下方法计算的:</p>
<blockquote>
<p>The terrain is estimated using the hypsometric equation. However, to calculate its trajectory model uses a sigma terrain following vertical coordinate that has been remapped internally from the vertical coordinate of the meteorological dataset. In that way we make sure that the trajectories do not go below the surface as defined in the original meteorological dataset.</p>
</blockquote>
<p>参考链接: <a target="_blank" rel="noopener" href="https://hysplitbbs.arl.noaa.gov/viewtopic.php?t=1068">https://hysplitbbs.arl.noaa.gov/viewtopic.php?t=1068</a></p>
<h2 id="particle-模式"><a href="#particle-模式" class="headerlink" title="particle 模式"></a>particle 模式</h2><p>particle模式跑到后面会越来越慢，因为</p>
<ul>
<li><p>测试1 批量进行气象数据缩小 （完成）</p>
</li>
<li><p>测试2 在stratosphere的粒子运动（最高30km）</p>
<blockquote>
<p>气象数据的最高高度为30km，如果直接设置30km会报错，可以设置为29.9km</p>
</blockquote>
</li>
<li><p>测试3 时间连接问题（完成）</p>
</li>
<li><p>问题4 粒子问题？（貌似有粒子的上限，以及如何对粒子释放做出修改）</p>
</li>
</ul>
<h2 id="测试1-批量进行气象数据缩小"><a href="#测试1-批量进行气象数据缩小" class="headerlink" title="测试1  批量进行气象数据缩小"></a>测试1  批量进行气象数据缩小</h2><p>根据教程中的介绍，貌似气象数据可以裁剪，为局部区域进行运行。因为这只是运移模型？</p>
<p>在下载的文件中，有个现成的软件可以进行气象数据的裁剪</p>
<blockquote>
<p>搜索 “xtrct_grid.exe，注意，文件夹的输入是C:\Users\zmjhh\Desktop\NCEP197611\，不要忘记最后要有个斜线<code>\</code>。</p>
</blockquote>
<blockquote>
<p># 思路 (使用shell文件完成)</p>
<p># &gt; 每次创建一个新的txt文件，将信息存入其中</p>
<p># &gt; 然后重定向输入到exe的应用程序中去 （重定行功能）</p>
<p># &gt; 最后将输出进行重命名 (mv函数)</p>
</blockquote>
<h2 id="测试2-在stratosphere的粒子运动（最高30km）"><a href="#测试2-在stratosphere的粒子运动（最高30km）" class="headerlink" title="测试2 在stratosphere的粒子运动（最高30km）"></a>测试2 在stratosphere的粒子运动（最高30km）</h2><p>运行基本ok，气象数据的最高高度为30km，如果设置粒子的释放高度超过30km（包括30km）有可能会报错，可以设置为29.9km。</p>
<img src="/2021/04/08/TrajectoryModel/hysplit-%E6%B5%8B%E8%AF%952/image-20210409152543732.png" alt="image-20210409152543732" style="zoom: 50%;">











<h1 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h1><ul>
<li>无</li>
</ul>

    </div>
    
    
    
    
    
      <footer class="post-footer">
    
        

    
        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/08/TrajectoryModel/hysplit_%E5%B8%B8%E9%97%AE%E7%9A%84%E9%97%AE%E9%A2%98/" rel="prev" title="hysplit_常问的问题">
      <i class="fa fa-chevron-left"></i> hysplit_常问的问题
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/04/08/pythonLearning/python-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="next" title="python_正则表达式">
      python_正则表达式 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%8F%E9%AA%8C"><span class="nav-number">1.</span> <span class="nav-text">经验</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AE%E9%A2%98"><span class="nav-number">2.</span> <span class="nav-text">问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#program-exception-access-violation%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">2.1.</span> <span class="nav-text">program exception-access violation的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NCEP-terrain-height%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">2.2.</span> <span class="nav-text">NCEP terrain height的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#particle-%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.3.</span> <span class="nav-text">particle 模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%951-%E6%89%B9%E9%87%8F%E8%BF%9B%E8%A1%8C%E6%B0%94%E8%B1%A1%E6%95%B0%E6%8D%AE%E7%BC%A9%E5%B0%8F"><span class="nav-number">2.4.</span> <span class="nav-text">测试1  批量进行气象数据缩小</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%952-%E5%9C%A8stratosphere%E7%9A%84%E7%B2%92%E5%AD%90%E8%BF%90%E5%8A%A8%EF%BC%88%E6%9C%80%E9%AB%9830km%EF%BC%89"><span class="nav-number">2.5.</span> <span class="nav-text">测试2 在stratosphere的粒子运动（最高30km）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%EF%BC%9A"><span class="nav-number">3.</span> <span class="nav-text">参考文献：</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">JackZheng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JackZheng</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">129k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:57</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
